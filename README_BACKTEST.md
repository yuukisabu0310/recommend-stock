# バックテスト実行方法

## 概要

バックテストスクリプトを使用して、アプリケーションの各機能が正常に動作することを検証します。

## 実行方法

```bash
python tests/backtest.py
```

## テスト内容

バックテストでは以下の機能を検証します：

1. **データ取得テスト**
   - 市場データの取得
   - データ構造の検証

2. **市場分析テスト**
   - スコア計算
   - Overviewテーブルの生成

3. **文章生成テスト**
   - フォールバック機能の動作確認
   - 分析文章の生成

4. **セクター分析テスト**
   - セクター分析の生成

5. **銘柄推奨テスト**
   - 銘柄データの取得
   - 推奨銘柄の生成

6. **Markdown生成テスト**
   - メインページの生成
   - ファイル出力の確認

7. **詳細ページ生成テスト**
   - 国別・期間別の詳細ページ生成

8. **思考ログ生成テスト**
   - 思考ログファイルの生成

## 注意事項

### APIレート制限
- Yahoo Finance APIにはレート制限があります
- テスト実行中に `429 Too Many Requests` エラーが発生する場合があります
- フォールバック機能により処理は継続されます

### 実行時間
- テスト実行には数秒〜数十秒かかります
- APIレート制限により、実際のデータ取得に時間がかかる場合があります

## 結果の確認

テスト実行後、以下を確認してください：

1. **コンソール出力**
   - 各テスト項目の結果（✓ または ❌）

2. **生成されたファイル**
   - `docs/test-index.md`: テスト用メインページ
   - `docs/details/`: 詳細ページ
   - `docs/logs/`: 思考ログ

3. **バックテストレポート**
   - `tests/BACKTEST_REPORT.md`: 詳細なレポート

## トラブルシューティング

### テストが失敗する場合

1. **依存パッケージの確認**
   ```bash
   pip install -r requirements.txt
   ```

2. **設定ファイルの確認**
   - `config/config.yml` が正しく配置されているか確認

3. **ログの確認**
   - コンソール出力のエラーメッセージを確認

## 継続的なテスト

GitHub Actionsで定期的にバックテストを実行する場合は、ワークフローに追加してください：

```yaml
- name: Run backtest
  run: python tests/backtest.py
```

